{"ast":null,"code":"var _jsxFileName = \"/home/fusion/workspace/frontend/src/ui/components/Book/BooksRender.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { toast } from 'react-toastify';\nimport bookApi from '../../../api/bookApi';\nimport { useAppSelector } from '../../../store';\nimport { routePath } from '../../../constants';\nimport CommonButton from '../CommonButton';\nimport Rating from '../Rating';\nimport BooksWrapper from './Books.styles';\nimport favoriteUnchoosenIcon from '../../images/fav-unchoosen.png';\nimport favoriteChoosenIcon from '../../images/favorites.png';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst BooksRender = props => {\n  _s();\n\n  const navigate = useNavigate();\n  const [favoritesIds, setFavoritesIds] = useState([]);\n  const user = useAppSelector(state => state.userReducer.user);\n  useEffect(() => {\n    const updatedFavoritesIds = [];\n    props.booksArray.forEach(book => {\n      if (book.isInFavorite) {\n        updatedFavoritesIds.push(book.bookId);\n      }\n    });\n    setFavoritesIds(updatedFavoritesIds);\n  }, [props.booksArray]);\n\n  const handleClickOnFavorite = async bookId => {\n    try {\n      if (!user) {\n        return navigate(routePath.signIn);\n      }\n\n      const indexInFavorites = favoritesIds.indexOf(bookId);\n\n      if (indexInFavorites !== -1) {\n        await bookApi.removeFromFavorite({\n          bookId\n        });\n        setFavoritesIds(favorites => favorites.filter(id => {\n          return id !== bookId;\n        }));\n\n        if (props.handleFavorites) {\n          props.handleFavorites(bookId);\n        }\n      } else {\n        await bookApi.addToFavorite({\n          bookId\n        });\n        setFavoritesIds([...favoritesIds, bookId]);\n      }\n    } catch (err) {\n      toast.error('Sorry, changing favorites is not available now', {\n        autoClose: 3000\n      });\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(BooksWrapper, {\n    wrap: props.wrap,\n    children: props.booksArray.map(book => {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"book\",\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          className: \"book__link\",\n          to: {\n            pathname: routePath.createProductURL(book.bookId.toString())\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: book.cover,\n            className: \"book__cover\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"book__title\",\n            children: book.title\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 13\n        }, this), favoritesIds.includes(book.bookId) ? /*#__PURE__*/_jsxDEV(\"img\", {\n          className: \"book__favorite\",\n          src: favoriteChoosenIcon,\n          onClick: () => handleClickOnFavorite(book.bookId)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 18\n        }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n          className: \"book__favorite\",\n          src: favoriteUnchoosenIcon,\n          onClick: () => handleClickOnFavorite(book.bookId)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 18\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"book__author\",\n          children: book.author\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"book__rating\",\n          children: [/*#__PURE__*/_jsxDEV(Rating, {\n            rate: book.averageRate,\n            isChangeRating: false,\n            bookId: book.bookId\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"book__average-rating\",\n            children: book.averageRate\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(CommonButton, {\n          size: \"container\",\n          text: `$${book.price} USD`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 13\n        }, this)]\n      }, book.bookId, true, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 11\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 62,\n    columnNumber: 5\n  }, this);\n};\n\n_s(BooksRender, \"YkLGGhPhEksWkNN5nYmtT4ljryo=\", false, function () {\n  return [useNavigate, useAppSelector];\n});\n\n_c = BooksRender;\nexport default BooksRender;\n\nvar _c;\n\n$RefreshReg$(_c, \"BooksRender\");","map":{"version":3,"names":["React","useEffect","useState","Link","useNavigate","toast","bookApi","useAppSelector","routePath","CommonButton","Rating","BooksWrapper","favoriteUnchoosenIcon","favoriteChoosenIcon","BooksRender","props","navigate","favoritesIds","setFavoritesIds","user","state","userReducer","updatedFavoritesIds","booksArray","forEach","book","isInFavorite","push","bookId","handleClickOnFavorite","signIn","indexInFavorites","indexOf","removeFromFavorite","favorites","filter","id","handleFavorites","addToFavorite","err","error","autoClose","wrap","map","pathname","createProductURL","toString","cover","title","includes","author","averageRate","price"],"sources":["/home/fusion/workspace/frontend/src/ui/components/Book/BooksRender.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { toast } from 'react-toastify';\n\nimport bookApi from '../../../api/bookApi';\nimport { useAppSelector } from '../../../store';\nimport { routePath } from '../../../constants';\nimport { BooksArray, BookType } from '../../../types';\n\nimport CommonButton from '../CommonButton';\nimport Rating from '../Rating';\nimport BooksWrapper from './Books.styles';\n\nimport favoriteUnchoosenIcon from '../../images/fav-unchoosen.png';\nimport favoriteChoosenIcon from '../../images/favorites.png';\n\ntype BookProps = {\n  booksArray: BooksArray;\n  wrap: 'wrap' | 'nowrap';\n  handleFavorites?: (id: number) => void;\n}\n\nconst BooksRender: React.FC<BookProps> = (props) => {\n  const navigate = useNavigate();\n  const [favoritesIds, setFavoritesIds] = useState<number[]>([]);\n  const user = useAppSelector((state) => state.userReducer.user);\n\n  useEffect(() => {\n    const updatedFavoritesIds: number[] = [];\n    props.booksArray.forEach((book) => {\n      if (book.isInFavorite) {\n        updatedFavoritesIds.push(book.bookId);\n      }\n    });\n    setFavoritesIds(updatedFavoritesIds);\n  }, [props.booksArray]);\n\n  const handleClickOnFavorite = async (bookId: number) => {\n    try {\n      if (!user) {\n        return navigate(routePath.signIn);\n      }\n      const indexInFavorites = favoritesIds.indexOf(bookId);\n      if (indexInFavorites !== -1) {\n        await bookApi.removeFromFavorite({ bookId });\n        setFavoritesIds((favorites) => favorites.filter((id) => {\n          return id !== bookId;\n        }));\n        if (props.handleFavorites) {\n          props.handleFavorites(bookId);\n        }\n      } else {\n        await bookApi.addToFavorite({ bookId });\n        setFavoritesIds([...favoritesIds, bookId]);\n      }\n    } catch (err) {\n      toast.error('Sorry, changing favorites is not available now', { autoClose: 3000 });\n    }\n  };\n\n  return (\n    <BooksWrapper\n      wrap={props.wrap}\n    >\n      {props.booksArray.map((book: BookType) => {\n        return (\n          <div\n            className=\"book\"\n            key={book.bookId}\n          >\n            <Link\n              className=\"book__link\"\n              to={{ pathname: routePath.createProductURL(book.bookId.toString()) }}>\n              <img\n                src={book.cover}\n                className=\"book__cover\"\n              />\n              <p className=\"book__title\">\n                {book.title}\n              </p>\n            </Link>\n            {favoritesIds.includes(book.bookId)\n              ? (<img\n                className=\"book__favorite\"\n                src={favoriteChoosenIcon}\n                onClick={() => handleClickOnFavorite(book.bookId)}\n              />)\n              : (<img\n                className=\"book__favorite\"\n                src={favoriteUnchoosenIcon}\n                onClick={() => handleClickOnFavorite(book.bookId)}\n              />)\n            }\n            <p className=\"book__author\">\n              {book.author}\n            </p>\n            <div className=\"book__rating\">\n              <Rating\n                rate={book.averageRate}\n                isChangeRating={false}\n                bookId={book.bookId}\n              />\n              <div className=\"book__average-rating\">\n                {book.averageRate}\n              </div>\n            </div>\n            <CommonButton\n              size=\"container\"\n              text={`$${book.price} USD`}\n            />\n          </div>\n        );\n      })}\n    </BooksWrapper>\n  );\n};\n\nexport default BooksRender;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}