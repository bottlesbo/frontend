{"ast":null,"code":"import _slicedToArray from\"/home/father/bookstore/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useCallback,useEffect,useState,useRef}from'react';import classnames from'classnames';import useQuery from'../../../../utils/useQuery';import PriceFilterWrapper from'../styles/PriceFilter.styles';import arrowUpIcon from'../../../images/arrow-up.png';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PriceFilter=function PriceFilter(props){var _useQuery=useQuery(),_useQuery2=_slicedToArray(_useQuery,2),setParams=_useQuery2[1];var _useState=useState(props.min),_useState2=_slicedToArray(_useState,2),minVal=_useState2[0],setMinVal=_useState2[1];var _useState3=useState(props.max),_useState4=_slicedToArray(_useState3,2),maxVal=_useState4[0],setMaxVal=_useState4[1];var minValRef=useRef(null);var maxValRef=useRef(null);var range=useRef(null);var getPercent=useCallback(function(value){return Math.round((value-props.min)/(props.max-props.min)*100);},[props.min,props.max]);useEffect(function(){if(maxValRef.current){var minPercent=getPercent(minVal);var maxPercent=getPercent(+maxValRef.current.value);if(range.current){range.current.style.left=\"\".concat(minPercent,\"%\");range.current.style.width=\"\".concat(maxPercent-minPercent,\"%\");}}},[minVal,getPercent]);useEffect(function(){if(minValRef.current){var minPercent=getPercent(+minValRef.current.value);var maxPercent=getPercent(maxVal);if(range.current){range.current.style.width=\"\".concat(maxPercent-minPercent,\"%\");}}},[maxVal,getPercent]);var setPriceRange=function setPriceRange(){setParams({priceFrom:minVal.toString(),priceTo:maxVal.toString()});};return/*#__PURE__*/_jsxs(PriceFilterWrapper,{onClick:function onClick(e){e.stopPropagation();},children:[/*#__PURE__*/_jsx(\"img\",{src:arrowUpIcon,className:\"arrow-up\"}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",min:props.min,max:props.max,value:minVal,ref:minValRef,onChange:function onChange(event){var value=Math.min(+event.target.value,maxVal-1);setMinVal(value);event.target.value=value.toString();},onMouseUp:setPriceRange,className:classnames('thumb thumb--zindex-3',{'thumb--zindex-5':minVal>props.max-100})}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",min:props.min,max:props.max,value:maxVal,ref:maxValRef,onChange:function onChange(event){var value=Math.max(+event.target.value,minVal+1);setMaxVal(value);event.target.value=value.toString();},onMouseUp:setPriceRange,className:\"thumb thumb--zindex-4\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"slider\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"slider__track\"}),/*#__PURE__*/_jsx(\"div\",{ref:range,className:\"slider__range\"}),/*#__PURE__*/_jsx(\"div\",{className:\"slider__left-value\",children:\"$ \".concat(minVal)}),/*#__PURE__*/_jsx(\"div\",{className:\"slider__right-value\",children:\"$ \".concat(maxVal)})]})]});};export default PriceFilter;","map":{"version":3,"names":["React","useCallback","useEffect","useState","useRef","classnames","useQuery","PriceFilterWrapper","arrowUpIcon","PriceFilter","props","setParams","min","minVal","setMinVal","max","maxVal","setMaxVal","minValRef","maxValRef","range","getPercent","value","Math","round","current","minPercent","maxPercent","style","left","width","setPriceRange","priceFrom","toString","priceTo","e","stopPropagation","event","target"],"sources":["/home/father/bookstore/frontend/src/ui/pages/home/components/PriceRangeFilter.tsx"],"sourcesContent":["import React, { ChangeEvent, FC, useCallback, useEffect, useState, useRef } from 'react';\nimport classnames from 'classnames';\n\nimport useQuery from '../../../../utils/useQuery';\nimport { QuerySearchOptions } from '../../../../types';\n\nimport PriceFilterWrapper from '../styles/PriceFilter.styles';\n\nimport arrowUpIcon from '../../../images/arrow-up.png';\n\ninterface MultiRangeSliderProps {\n  min: number;\n  max: number;\n}\n\nconst PriceFilter: FC<MultiRangeSliderProps> = (props) => {\n  const [, setParams] = useQuery<QuerySearchOptions>();\n\n  const [minVal, setMinVal] = useState(props.min);\n  const [maxVal, setMaxVal] = useState(props.max);\n  const minValRef = useRef<HTMLInputElement>(null);\n  const maxValRef = useRef<HTMLInputElement>(null);\n  const range = useRef<HTMLDivElement>(null);\n\n  const getPercent = useCallback(\n    (value: number) => Math.round(((value - props.min) / (props.max - props.min)) * 100),\n    [props.min, props.max],\n  );\n\n  useEffect(() => {\n    if (maxValRef.current) {\n      const minPercent = getPercent(minVal);\n      const maxPercent = getPercent(+maxValRef.current.value);\n\n      if (range.current) {\n        range.current.style.left = `${minPercent}%`;\n        range.current.style.width = `${maxPercent - minPercent}%`;\n      }\n    }\n  }, [minVal, getPercent]);\n\n  useEffect(() => {\n    if (minValRef.current) {\n      const minPercent = getPercent(+minValRef.current.value);\n      const maxPercent = getPercent(maxVal);\n\n      if (range.current) {\n        range.current.style.width = `${maxPercent - minPercent}%`;\n      }\n    }\n  }, [maxVal, getPercent]);\n\n  const setPriceRange: React.MouseEventHandler<HTMLDivElement> = () => {\n    setParams({\n      priceFrom: minVal.toString(),\n      priceTo: maxVal.toString(),\n    });\n  };\n\n  return (\n    <PriceFilterWrapper\n      onClick={(e) => {\n        e.stopPropagation();\n      }}\n    >\n      <img\n        src={arrowUpIcon}\n        className=\"arrow-up\"\n      />\n\n      <input\n        type=\"range\"\n        min={props.min}\n        max={props.max}\n        value={minVal}\n        ref={minValRef}\n        onChange={(event: ChangeEvent<HTMLInputElement>) => {\n          const value = Math.min(+event.target.value, maxVal - 1);\n          setMinVal(value);\n          event.target.value = value.toString();\n        }}\n        onMouseUp={setPriceRange}\n        className={classnames('thumb thumb--zindex-3', {\n          'thumb--zindex-5': minVal > props.max - 100,\n        })}\n      />\n      <input\n        type=\"range\"\n        min={props.min}\n        max={props.max}\n        value={maxVal}\n        ref={maxValRef}\n        onChange={(event: ChangeEvent<HTMLInputElement>) => {\n          const value = Math.max(+event.target.value, minVal + 1);\n          setMaxVal(value);\n          event.target.value = value.toString();\n        }}\n        onMouseUp={setPriceRange}\n        className=\"thumb thumb--zindex-4\"\n      />\n\n      <div className=\"slider\">\n        <div className=\"slider__track\" />\n        <div ref={range} className=\"slider__range\" />\n        <div className=\"slider__left-value\" >\n          {`$ ${minVal}`}\n        </div>\n        <div className=\"slider__right-value\" >\n          {`$ ${maxVal}`}\n        </div>\n      </div>\n    </PriceFilterWrapper>\n  );\n};\n\nexport default PriceFilter;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}