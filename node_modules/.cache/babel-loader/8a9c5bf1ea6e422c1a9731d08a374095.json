{"ast":null,"code":"import _asyncToGenerator from\"/home/father/bookstore/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/home/father/bookstore/frontend/node_modules/@babel/runtime/regenerator/index.js\";import React from'react';import{useFormik}from'formik';import YupString from'yup/lib/string';import YupObject from'yup/lib/object';import{Link,useNavigate}from'react-router-dom';import{AxiosError}from'axios';import authAPI from'../../../api/authApi';import{useAppDispatch}from'../../../store';import{setUser}from'../../../store/userReducer';import{routePath}from'../../../constants';import CommonInputField from'../../components/CommonInputField';import CommonButton from'../../components/CommonButton';import CommonWrapper from'../../components/CommonWrapper.styles';import Wrapper from'./Auth.styles';import man from'../../images/man.png';import hide from'../../images/hide.png';import mail from'../../images/mail.png';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var signInValidationSchema=new YupObject().shape({email:new YupString().email('Invalid email address').required('Required'),password:new YupString().required('Required')});var SignInForm=function SignInForm(){var dispatch=useAppDispatch();var navigate=useNavigate();var formik=useFormik({initialValues:{email:'',password:''},validationSchema:signInValidationSchema,onSubmit:function(){var _onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(values){var response,_error$response,status,_error$response2,_error$response3;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return authAPI.signIn({email:values.email,password:values.password});case 3:response=_context.sent;dispatch(setUser(response.data.user));return _context.abrupt(\"return\",navigate(\"\".concat(routePath.home)));case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);if(_context.t0 instanceof AxiosError){status=(_error$response=_context.t0.response)===null||_error$response===void 0?void 0:_error$response.status;if(status===403){formik.setErrors({password:(_error$response2=_context.t0.response)===null||_error$response2===void 0?void 0:_error$response2.data.data.message});}if(status===404){formik.setErrors({email:(_error$response3=_context.t0.response)===null||_error$response3===void 0?void 0:_error$response3.data.data.message});}}case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));function onSubmit(_x){return _onSubmit.apply(this,arguments);}return onSubmit;}()});return/*#__PURE__*/_jsx(CommonWrapper,{children:/*#__PURE__*/_jsxs(Wrapper,{children:[/*#__PURE__*/_jsxs(\"form\",{className:\"form-wrapper\",onSubmit:formik.handleSubmit,children:[/*#__PURE__*/_jsx(\"h1\",{className:\"title\",children:\"Log In\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-wrapper\",children:[/*#__PURE__*/_jsx(CommonInputField,{icon:mail,name:\"email\",placeholder:\"Email\",fieldInputProps:formik.getFieldProps('email'),error:formik!==null&&formik!==void 0&&formik.touched.email?formik===null||formik===void 0?void 0:formik.errors.email:''}),/*#__PURE__*/_jsx(\"p\",{className:\"form__text\",children:\"Enter your email\"}),/*#__PURE__*/_jsx(CommonInputField,{icon:hide,type:\"password\",name:\"password\",placeholder:\"Password\",fieldInputProps:formik.getFieldProps('password'),error:formik!==null&&formik!==void 0&&formik.touched.password?formik===null||formik===void 0?void 0:formik.errors.password:''}),/*#__PURE__*/_jsx(\"p\",{className:\"form__text\",children:\"Enter your password\"})]}),/*#__PURE__*/_jsx(CommonButton,{size:\"permanent\",text:\"Log In\"}),/*#__PURE__*/_jsxs(\"h4\",{className:\"question\",children:[\"Don`t you have an account yet? \\xA0\",/*#__PURE__*/_jsx(Link,{to:routePath.signUp,className:\"button\",children:/*#__PURE__*/_jsx(\"span\",{children:\"Let`s sign up!\"})})]})]}),/*#__PURE__*/_jsx(\"img\",{className:\"image\",src:man})]})});};export default SignInForm;","map":{"version":3,"names":["React","useFormik","YupString","YupObject","Link","useNavigate","AxiosError","authAPI","useAppDispatch","setUser","routePath","CommonInputField","CommonButton","CommonWrapper","Wrapper","man","hide","mail","signInValidationSchema","shape","email","required","password","SignInForm","dispatch","navigate","formik","initialValues","validationSchema","onSubmit","values","signIn","response","data","user","home","status","setErrors","message","handleSubmit","getFieldProps","touched","errors","signUp"],"sources":["/home/father/bookstore/frontend/src/ui/pages/auth/SignIn.tsx"],"sourcesContent":["import React from 'react';\nimport { useFormik } from 'formik';\nimport YupString from 'yup/lib/string';\nimport YupObject from 'yup/lib/object';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { AxiosError } from 'axios';\n\nimport authAPI from '../../../api/authApi';\nimport { useAppDispatch } from '../../../store';\nimport { setUser } from '../../../store/userReducer';\nimport { routePath } from '../../../constants';\n\nimport CommonInputField from '../../components/CommonInputField';\nimport CommonButton from '../../components/CommonButton';\nimport CommonWrapper from '../../components/CommonWrapper.styles';\nimport Wrapper from './Auth.styles';\n\nimport man from '../../images/man.png';\nimport hide from '../../images/hide.png';\nimport mail from '../../images/mail.png';\n\nconst signInValidationSchema = new YupObject().shape({\n  email: new YupString().email('Invalid email address').required('Required'),\n  password: new YupString().required('Required'),\n});\n\nconst SignInForm = () => {\n  const dispatch = useAppDispatch();\n  const navigate = useNavigate();\n  const formik = useFormik({\n    initialValues: {\n      email: '',\n      password: '',\n    },\n    validationSchema: signInValidationSchema,\n    onSubmit: async (values) => {\n      try {\n        const response = await authAPI.signIn({\n          email: values.email,\n          password: values.password,\n        });\n        dispatch(setUser(response.data.user));\n\n        return navigate(`${routePath.home}`);\n      } catch (error) {\n        if (error instanceof AxiosError) {\n          const status = error.response?.status;\n          if (status === 403) {\n            formik.setErrors({\n              password: error.response?.data.data.message,\n            });\n          }\n          if (status === 404) {\n            formik.setErrors({\n              email: error.response?.data.data.message,\n            });\n          }\n        }\n      }\n    },\n  });\n\n  return (\n    <CommonWrapper>\n      <Wrapper>\n        <form\n          className=\"form-wrapper\"\n          onSubmit={formik.handleSubmit}\n        >\n          <h1 className=\"title\">\n            Log In\n          </h1>\n\n          <div className=\"input-wrapper\">\n            <CommonInputField\n              icon={mail}\n              name=\"email\"\n              placeholder=\"Email\"\n              fieldInputProps={formik.getFieldProps('email')}\n              error={formik?.touched.email ? formik?.errors.email : ''}\n            />\n            <p className=\"form__text\">\n              Enter your email\n            </p>\n\n            <CommonInputField\n              icon={hide}\n              type=\"password\"\n              name=\"password\"\n              placeholder=\"Password\"\n              fieldInputProps={formik.getFieldProps('password')}\n              error={formik?.touched.password ? formik?.errors.password : ''}\n            />\n            <p className=\"form__text\">\n              Enter your password\n            </p>\n          </div>\n          <CommonButton\n            size=\"permanent\"\n            text=\"Log In\"\n          />\n          <h4 className=\"question\">\n            Don`t you have an account yet? &nbsp;\n            <Link to={routePath.signUp} className=\"button\">\n              <span>Let`s sign up!</span>\n            </Link>\n          </h4>\n        </form>\n        <img\n          className=\"image\"\n          src={man}\n        />\n      </Wrapper>\n    </CommonWrapper>\n  );\n};\n\nexport default SignInForm;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}