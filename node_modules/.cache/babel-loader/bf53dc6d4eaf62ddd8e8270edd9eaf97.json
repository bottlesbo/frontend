{"ast":null,"code":"var _jsxFileName = \"/home/father/bookstore/frontend/src/ui/pages/userProfile/components/UserPassword.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport { AxiosError } from 'axios';\nimport { toast } from 'react-toastify';\nimport { useFormik } from 'formik';\nimport YupString from 'yup/lib/string';\nimport YupObject from 'yup/lib/object';\nimport YupRef from 'yup/lib/Reference';\nimport userApi from '../../../../api/userApi';\nimport { useAppSelector } from '../../../../store';\nimport CommonInputField from '../../../components/CommonInputField';\nimport CommonButton from '../../../components/CommonButton';\nimport hideIcon from '../../../images/hide.png';\nimport showIcon from '../../../images/view.png';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst changePasswordValidationSchema = new YupObject().shape({\n  oldPassword: new YupString().required('Required'),\n  password: new YupString().required('Required'),\n  passwordRepeat: new YupString().when('password', {\n    is: value => Boolean(value && value.length > 0),\n    then: new YupString().oneOf([new YupRef('password')], 'Both passwords need to be the same')\n  })\n});\n\nconst UserPassword = props => {\n  _s();\n\n  const user = useAppSelector(state => state.userReducer.user);\n  const [isPasswordVisible, setIsPasswordVisible] = useState(false);\n  const formik = useFormik({\n    initialValues: {\n      oldPassword: '',\n      password: '',\n      passwordRepeat: ''\n    },\n    validationSchema: changePasswordValidationSchema,\n    onSubmit: async values => {\n      try {\n        const {\n          password,\n          oldPassword\n        } = values;\n        await userApi.updateUser(user.id, {\n          oldPassword,\n          password\n        });\n        props.toggleChangePassword();\n        formik.setStatus('Success!');\n        setTimeout(() => {\n          formik.setStatus(false);\n        }, 2000);\n      } catch (error) {\n        if (error instanceof AxiosError) {\n          var _error$response;\n\n          const status = (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status;\n\n          if (status === 403) {\n            var _error$response2;\n\n            formik.setErrors({\n              oldPassword: (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data.data.message\n            });\n          }\n        } else {\n          toast.error('Sorry, something went wrong...', {\n            autoClose: 3000\n          });\n        }\n      }\n    }\n  });\n  const icon = isPasswordVisible ? showIcon : hideIcon;\n  const inputType = isPasswordVisible ? 'text' : 'password';\n\n  const togglePasswordVisibility = () => {\n    setIsPasswordVisible(!isPasswordVisible);\n  };\n\n  if (props.isChangePassword) {\n    return /*#__PURE__*/_jsxDEV(CommonInputField, {\n      icon: hideIcon,\n      name: \"password\",\n      hint: \"Your password\",\n      placeholder: \"********\",\n      disabled: true,\n      success: formik.status\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onKeyDown: e => {\n      if (e.key === 'Enter') {\n        formik.handleSubmit();\n      }\n    },\n    onSubmit: formik.handleSubmit,\n    children: [/*#__PURE__*/_jsxDEV(CommonInputField, {\n      icon: icon,\n      name: \"oldPassword\",\n      hint: \"Old password\",\n      placeholder: \"*************\",\n      type: inputType,\n      fieldInputProps: formik.getFieldProps('oldPassword'),\n      error: formik !== null && formik !== void 0 && formik.touched.oldPassword ? formik === null || formik === void 0 ? void 0 : formik.errors.oldPassword : '',\n      onClickOnIcon: togglePasswordVisibility\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(CommonInputField, {\n      icon: icon,\n      name: \"password\",\n      type: \"password\",\n      placeholder: \"New password\",\n      fieldInputProps: formik.getFieldProps('password'),\n      error: formik !== null && formik !== void 0 && formik.touched.password ? formik === null || formik === void 0 ? void 0 : formik.errors.password : '',\n      onClickOnIcon: togglePasswordVisibility\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Enter your password\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(CommonInputField, {\n      icon: icon,\n      placeholder: \"Password replay\",\n      type: \"password\",\n      name: \"passwordRepeat\",\n      fieldInputProps: formik.getFieldProps('passwordRepeat'),\n      error: formik !== null && formik !== void 0 && formik.touched.passwordRepeat ? formik === null || formik === void 0 ? void 0 : formik.errors.passwordRepeat : '',\n      onClickOnIcon: togglePasswordVisibility\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Repeat your passport withour errors\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(CommonButton, {\n      text: \"Confirm\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 92,\n    columnNumber: 5\n  }, this);\n};\n\n_s(UserPassword, \"1QrZeRWsNQDRSblQq0hoWkJm/rs=\", false, function () {\n  return [useAppSelector, useFormik];\n});\n\n_c = UserPassword;\nexport default UserPassword;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserPassword\");","map":{"version":3,"names":["React","useState","AxiosError","toast","useFormik","YupString","YupObject","YupRef","userApi","useAppSelector","CommonInputField","CommonButton","hideIcon","showIcon","changePasswordValidationSchema","shape","oldPassword","required","password","passwordRepeat","when","is","value","Boolean","length","then","oneOf","UserPassword","props","user","state","userReducer","isPasswordVisible","setIsPasswordVisible","formik","initialValues","validationSchema","onSubmit","values","updateUser","id","toggleChangePassword","setStatus","setTimeout","error","status","response","setErrors","data","message","autoClose","icon","inputType","togglePasswordVisibility","isChangePassword","e","key","handleSubmit","getFieldProps","touched","errors"],"sources":["/home/father/bookstore/frontend/src/ui/pages/userProfile/components/UserPassword.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { AxiosError } from 'axios';\nimport { toast } from 'react-toastify';\nimport { useFormik } from 'formik';\n\nimport YupString from 'yup/lib/string';\nimport YupObject from 'yup/lib/object';\nimport YupRef from 'yup/lib/Reference';\n\nimport userApi from '../../../../api/userApi';\nimport { useAppSelector } from '../../../../store';\nimport { User } from '../../../../types';\n\nimport CommonInputField from '../../../components/CommonInputField';\nimport CommonButton from '../../../components/CommonButton';\n\nimport hideIcon from '../../../images/hide.png';\nimport showIcon from '../../../images/view.png';\n\ntype UserProfileProps = {\n  isChangePassword: boolean;\n  toggleChangePassword: () => void;\n}\n\nconst changePasswordValidationSchema = new YupObject().shape({\n  oldPassword: new YupString().required('Required'),\n  password: new YupString().required('Required'),\n  passwordRepeat: new YupString().when('password', {\n    is: (value: string) => (Boolean(value && value.length > 0)),\n    then: new YupString().oneOf(\n      [new YupRef('password')],\n      'Both passwords need to be the same',\n    ),\n  }),\n});\n\nconst UserPassword: React.FC<UserProfileProps> = (props) => {\n  const user = useAppSelector((state) => state.userReducer.user) as User;\n  const [isPasswordVisible, setIsPasswordVisible] = useState(false);\n\n  const formik = useFormik({\n    initialValues: {\n      oldPassword: '',\n      password: '',\n      passwordRepeat: '',\n    },\n    validationSchema: changePasswordValidationSchema,\n    onSubmit: async (values) => {\n      try {\n        const { password, oldPassword } = values;\n        await userApi.updateUser(user.id, { oldPassword, password });\n        props.toggleChangePassword();\n        formik.setStatus('Success!');\n        setTimeout(() => {\n          formik.setStatus(false);\n        }, 2000);\n      } catch (error) {\n        if (error instanceof AxiosError) {\n          const status = error.response?.status;\n          if (status === 403) {\n            formik.setErrors({\n              oldPassword: error.response?.data.data.message,\n            });\n          }\n        } else {\n          toast.error('Sorry, something went wrong...', { autoClose: 3000 });\n        }\n      }\n    },\n  });\n\n  const icon = isPasswordVisible ? showIcon : hideIcon;\n  const inputType = isPasswordVisible ? 'text' : 'password';\n\n  const togglePasswordVisibility = () => {\n    setIsPasswordVisible(!isPasswordVisible);\n  };\n\n  if (props.isChangePassword) {\n    return (\n      <CommonInputField\n        icon={hideIcon}\n        name=\"password\"\n        hint=\"Your password\"\n        placeholder=\"********\"\n        disabled={true}\n        success={formik.status}\n      />\n    );\n  }\n  return (\n    <form\n      onKeyDown={(e) => {\n        if (e.key === 'Enter') {\n          formik.handleSubmit();\n        }\n      }}\n      onSubmit={formik.handleSubmit}\n    >\n      <CommonInputField\n        icon={icon}\n        name=\"oldPassword\"\n        hint=\"Old password\"\n        placeholder=\"*************\"\n        type={inputType}\n        fieldInputProps={formik.getFieldProps('oldPassword')}\n        error={formik?.touched.oldPassword ? formik?.errors.oldPassword : ''}\n        onClickOnIcon={togglePasswordVisibility}\n      />\n      <CommonInputField\n        icon={icon}\n        name=\"password\"\n        type=\"password\"\n        placeholder=\"New password\"\n        fieldInputProps={formik.getFieldProps('password')}\n        error={formik?.touched.password ? formik?.errors.password : ''}\n        onClickOnIcon={togglePasswordVisibility}\n      />\n      <p>Enter your password</p>\n      <CommonInputField\n        icon={icon}\n        placeholder=\"Password replay\"\n        type=\"password\"\n        name=\"passwordRepeat\"\n        fieldInputProps={formik.getFieldProps('passwordRepeat')}\n        error={formik?.touched.passwordRepeat ? formik?.errors.passwordRepeat : ''}\n        onClickOnIcon={togglePasswordVisibility}\n      />\n      <p>Repeat your passport withour errors</p>\n      <CommonButton\n        text=\"Confirm\"\n      />\n    </form>\n  );\n};\n\nexport default UserPassword;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}