{"ast":null,"code":"var _jsxFileName = \"/home/fusion/workspace/frontend/src/ui/pages/productPage/ProductPage.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router';\nimport { toast } from 'react-toastify';\nimport bookApi from '../../../api/bookApi';\nimport { useAppSelector } from '../../../store';\nimport { routePath } from '../../../constants';\nimport CommonButton from '../../components/CommonButton';\nimport Rating from '../../components/Rating';\nimport Comments from './components/Comments';\nimport AuthProtector from '../../components/AuthProtector';\nimport AuthorizeBanner from '../../components/AuthorizeBanner';\nimport Recommendations from './components/Recommendation';\nimport CommonWrapper from '../../components/CommonWrapper.styles';\nimport ProductPageWrapper from './ProductPage.styles';\nimport filledStarIcon from '../../images/star-filled.png';\nimport backArrow from '../../images/back-arrow.png';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst ProductPage = () => {\n  _s();\n\n  var _user$ratings;\n\n  const navigate = useNavigate();\n  const [book, setBook] = useState();\n  const [isChangeRating, setIsChangeRating] = useState(false);\n  const user = useAppSelector(state => state.userReducer.user);\n  const params = useParams();\n\n  const setBookInState = book => {\n    setBook(book);\n  };\n\n  useEffect(() => {\n    try {\n      (async () => {\n        if (!params.id) return;\n        const response = await bookApi.getOneBook(params.id);\n        setBookInState(response.data.book);\n      })();\n    } catch (err) {\n      toast.error('Sorry, something went wrong...', {\n        autoClose: 3000\n      });\n    }\n  }, [params.id]);\n  if (!book) return null;\n\n  const handleChangeRating = () => {\n    if (!user) {\n      return navigate(routePath.signIn);\n    }\n\n    setIsChangeRating(!isChangeRating);\n  };\n\n  const currentUserRating = user === null || user === void 0 ? void 0 : (_user$ratings = user.ratings) === null || _user$ratings === void 0 ? void 0 : _user$ratings.find(item => {\n    return item.book.bookId === book.bookId;\n  });\n  return /*#__PURE__*/_jsxDEV(CommonWrapper, {\n    children: [/*#__PURE__*/_jsxDEV(ProductPageWrapper, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"cover\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          className: \"cover__img\",\n          src: book.cover\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"book-info\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"book-info__title\",\n          children: book.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"book-info__subtitle\",\n          children: book.author\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rating\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rating__average\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: filledStarIcon,\n              className: \"icon\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 77,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"rating__update\",\n              children: book.averageRate\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 81,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Rating, {\n            bookId: book.bookId,\n            rate: (currentUserRating === null || currentUserRating === void 0 ? void 0 : currentUserRating.rating) || 0,\n            isChangeRating: isChangeRating,\n            handleChangeRating: handleChangeRating\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rating__update\",\n            onClick: handleChangeRating,\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              className: \"rating__arrow\",\n              src: backArrow\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 95,\n              columnNumber: 15\n            }, this), isChangeRating || !(currentUserRating !== null && currentUserRating !== void 0 && currentUserRating.rating) ? /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Rate this book\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Update rating\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 98,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"description\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"book-info__subtitle description__title\",\n          children: \"Description\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"description__text\",\n          children: book.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"buttons-block\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"button-block__button\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"button-block__description\",\n              children: \"Paperback\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 111,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(CommonButton, {\n              size: \"container\",\n              text: \"Not available\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 114,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"button-block__button\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"button-block__description\",\n              children: \"Hardcover\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 120,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(CommonButton, {\n              size: \"container\",\n              text: `$ ${book.price} USD`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 123,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Comments, {\n      setBookInState: setBookInState,\n      book: book\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(AuthProtector, {\n      noAuthOnly: true,\n      children: /*#__PURE__*/_jsxDEV(AuthorizeBanner, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Recommendations, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 5\n  }, this);\n};\n\n_s(ProductPage, \"EFcYJ97qcGhJItOk2xz8eG9YEGk=\", false, function () {\n  return [useNavigate, useAppSelector, useParams];\n});\n\n_c = ProductPage;\nexport default ProductPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProductPage\");","map":{"version":3,"names":["React","useEffect","useState","useNavigate","useParams","toast","bookApi","useAppSelector","routePath","CommonButton","Rating","Comments","AuthProtector","AuthorizeBanner","Recommendations","CommonWrapper","ProductPageWrapper","filledStarIcon","backArrow","ProductPage","navigate","book","setBook","isChangeRating","setIsChangeRating","user","state","userReducer","params","setBookInState","id","response","getOneBook","data","err","error","autoClose","handleChangeRating","signIn","currentUserRating","ratings","find","item","bookId","cover","title","author","averageRate","rating","description","price"],"sources":["/home/fusion/workspace/frontend/src/ui/pages/productPage/ProductPage.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router';\nimport { toast } from 'react-toastify';\n\nimport bookApi from '../../../api/bookApi';\nimport { useAppSelector } from '../../../store';\nimport { BookType, RatingObj } from '../../../types';\nimport { routePath } from '../../../constants';\n\nimport CommonButton from '../../components/CommonButton';\nimport Rating from '../../components/Rating';\nimport Comments from './components/Comments';\nimport AuthProtector from '../../components/AuthProtector';\nimport AuthorizeBanner from '../../components/AuthorizeBanner';\nimport Recommendations from './components/Recommendation';\nimport CommonWrapper from '../../components/CommonWrapper.styles';\n\nimport ProductPageWrapper from './ProductPage.styles';\n\nimport filledStarIcon from '../../images/star-filled.png';\nimport backArrow from '../../images/back-arrow.png';\n\nconst ProductPage = () => {\n  const navigate = useNavigate();\n  const [book, setBook] = useState<BookType>();\n  const [isChangeRating, setIsChangeRating] = useState(false);\n  const user = useAppSelector((state) => state.userReducer.user);\n  const params = useParams();\n\n  const setBookInState = (book: BookType) => {\n    setBook(book);\n  };\n\n  useEffect(() => {\n    try {\n      (async () => {\n        if (!params.id) return;\n        const response = await bookApi.getOneBook(params.id);\n        setBookInState(response.data.book);\n      })();\n    } catch (err) {\n      toast.error('Sorry, something went wrong...', { autoClose: 3000 });\n    }\n  }, [params.id]);\n\n  if (!book) return null;\n\n  const handleChangeRating = () => {\n    if (!user) {\n      return navigate(routePath.signIn);\n    }\n\n    setIsChangeRating(!isChangeRating);\n  };\n\n  const currentUserRating = user?.ratings?.find((item: RatingObj) => {\n    return item.book.bookId === book.bookId;\n  });\n  return (\n    <CommonWrapper>\n      <ProductPageWrapper>\n        <div className=\"cover\">\n          <img\n            className=\"cover__img\"\n            src={book.cover}\n          />\n        </div>\n        <div className=\"book-info\">\n          <p className=\"book-info__title\">\n            {book.title}\n          </p>\n          <p className=\"book-info__subtitle\">\n            {book.author}\n          </p>\n          <div className=\"rating\">\n            <div className=\"rating__average\">\n              <img\n                src={filledStarIcon}\n                className=\"icon\"\n              />\n              <div className=\"rating__update\">\n                {book.averageRate}\n              </div>\n            </div>\n            <Rating\n              bookId={book.bookId}\n              rate={currentUserRating?.rating || 0}\n              isChangeRating={isChangeRating}\n              handleChangeRating={handleChangeRating}\n            />\n            <div\n              className=\"rating__update\"\n              onClick={handleChangeRating}\n            >\n              <img className=\"rating__arrow\" src={backArrow} />\n              {isChangeRating || !currentUserRating?.rating\n                ? <p>Rate this book</p>\n                : <p>Update rating</p>}\n            </div>\n          </div>\n        </div>\n        <div className=\"description\">\n          <p className=\"book-info__subtitle description__title\">\n            Description\n          </p>\n          <p className=\"description__text\">\n            {book.description}\n          </p>\n          <div className=\"buttons-block\">\n            <div className=\"button-block__button\">\n              <p className=\"button-block__description\">\n                Paperback\n              </p>\n              <CommonButton\n                size=\"container\"\n                text=\"Not available\"\n              />\n            </div>\n            <div className=\"button-block__button\">\n              <p className=\"button-block__description\">\n                Hardcover\n              </p>\n              <CommonButton\n                size=\"container\"\n                text={`$ ${book.price} USD`}\n              />\n            </div>\n          </div>\n        </div>\n      </ProductPageWrapper>\n      <Comments\n        setBookInState={setBookInState}\n        book={book}\n      />\n      <AuthProtector\n        noAuthOnly\n      >\n        <AuthorizeBanner />\n      </AuthProtector>\n      <Recommendations />\n    </CommonWrapper>\n  );\n};\n\nexport default ProductPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}