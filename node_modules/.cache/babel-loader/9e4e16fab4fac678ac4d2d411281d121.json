{"ast":null,"code":"import _asyncToGenerator from\"/home/father/bookstore/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/home/father/bookstore/frontend/node_modules/@babel/runtime/regenerator/index.js\";import React from'react';import{useFormik}from'formik';import CommonInputField from'../../../components/CommonInputField';import userApi from'../../../../api/userApi';import{useAppDispatch,useAppSelector}from'../../../../store';import{setUser}from'../../../../store/userReducer';import CommonButton from'../../../components/CommonButton';import defaultAvatar from'../../../images/default-avatar.png';import mailIcon from'../../../images/mail.png';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var UserInfo=function UserInfo(props){var dispatch=useAppDispatch();var user=useAppSelector(function(state){return state.userReducer.user;});var formik=useFormik({initialValues:{name:user.name||'',email:user.email},onSubmit:function(){var _onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(values){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return userApi.updateUser(user.id,values);case 3:response=_context.sent;dispatch(setUser(response.data.user));props.toggleChangeUserInfo();formik.setStatus('Success!');setTimeout(function(){formik.setStatus(false);},2000);_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.log('ERROR >>',_context.t0);case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));function onSubmit(_x){return _onSubmit.apply(this,arguments);}return onSubmit;}()});return/*#__PURE__*/_jsxs(\"form\",{onSubmit:formik.handleSubmit,children:[/*#__PURE__*/_jsx(CommonInputField,{icon:defaultAvatar,hint:\"Your name\",value:user===null||user===void 0?void 0:user.name,name:\"name\",disabled:!props.isChangeUserInfo,fieldInputProps:formik.getFieldProps('name'),error:formik!==null&&formik!==void 0&&formik.touched.email?formik===null||formik===void 0?void 0:formik.errors.name:'',success:formik.status}),/*#__PURE__*/_jsx(CommonInputField,{icon:mailIcon,hint:\"Your email\",value:user===null||user===void 0?void 0:user.email,name:\"email\",disabled:!props.isChangeUserInfo,fieldInputProps:formik.getFieldProps('email'),error:formik!==null&&formik!==void 0&&formik.touched.email?formik===null||formik===void 0?void 0:formik.errors.email:'',success:formik.status}),props.isChangeUserInfo&&/*#__PURE__*/_jsx(CommonButton,{text:\"Confirm\"})]});};export default UserInfo;","map":{"version":3,"names":["React","useFormik","CommonInputField","userApi","useAppDispatch","useAppSelector","setUser","CommonButton","defaultAvatar","mailIcon","UserInfo","props","dispatch","user","state","userReducer","formik","initialValues","name","email","onSubmit","values","updateUser","id","response","data","toggleChangeUserInfo","setStatus","setTimeout","console","log","handleSubmit","isChangeUserInfo","getFieldProps","touched","errors","status"],"sources":["/home/father/bookstore/frontend/src/ui/pages/userProfile/components/UserInfo.tsx"],"sourcesContent":["import React from 'react';\nimport { useFormik } from 'formik';\n\nimport CommonInputField from '../../../components/CommonInputField';\n\nimport userApi from '../../../../api/userApi';\nimport { useAppDispatch, useAppSelector } from '../../../../store';\nimport { setUser } from '../../../../store/userReducer';\nimport { User } from '../../../../types';\n\nimport CommonButton from '../../../components/CommonButton';\n\nimport defaultAvatar from '../../../images/default-avatar.png';\nimport mailIcon from '../../../images/mail.png';\n\ntype UserInfoProps = {\n  isChangeUserInfo: boolean;\n  disabled?: boolean;\n  toggleChangeUserInfo: () => void;\n}\n\nconst UserInfo: React.FC<UserInfoProps> = (props) => {\n  const dispatch = useAppDispatch();\n  const user = useAppSelector((state) => state.userReducer.user) as User;\n\n  const formik = useFormik({\n    initialValues: {\n      name: user.name || '',\n      email: user.email,\n    },\n    onSubmit: async (values) => {\n      try {\n        const response = await userApi.updateUser(user.id, values);\n        dispatch(setUser(response.data.user));\n        props.toggleChangeUserInfo();\n        formik.setStatus('Success!');\n        setTimeout(() => {\n          formik.setStatus(false);\n        }, 2000);\n      } catch (error) {\n        console.log('ERROR >>', error);\n      }\n    },\n  });\n  return (\n    <form\n      onSubmit={formik.handleSubmit}\n    >\n      <CommonInputField\n        icon={defaultAvatar}\n        hint=\"Your name\"\n        value={user?.name}\n        name=\"name\"\n        disabled={!props.isChangeUserInfo}\n        fieldInputProps={formik.getFieldProps('name')}\n        error={formik?.touched.email ? formik?.errors.name : ''}\n        success={formik.status}\n      />\n      <CommonInputField\n        icon={mailIcon}\n        hint=\"Your email\"\n        value={user?.email}\n        name=\"email\"\n        disabled={!props.isChangeUserInfo}\n        fieldInputProps={formik.getFieldProps('email')}\n        error={formik?.touched.email ? formik?.errors.email : ''}\n        success={formik.status}\n      />\n      {props.isChangeUserInfo &&\n        <CommonButton\n          text=\"Confirm\"\n        />\n      }\n    </form>\n  );\n};\n\nexport default UserInfo;\n"],"mappings":"6OAAA,MAAOA,MAAP,KAAkB,OAAlB,CACA,OAASC,SAAT,KAA0B,QAA1B,CAEA,MAAOC,iBAAP,KAA6B,sCAA7B,CAEA,MAAOC,QAAP,KAAoB,yBAApB,CACA,OAASC,cAAT,CAAyBC,cAAzB,KAA+C,mBAA/C,CACA,OAASC,OAAT,KAAwB,+BAAxB,CAGA,MAAOC,aAAP,KAAyB,kCAAzB,CAEA,MAAOC,cAAP,KAA0B,oCAA1B,CACA,MAAOC,SAAP,KAAqB,0BAArB,C,wFAQA,GAAMC,SAAiC,CAAG,QAApCA,SAAoC,CAACC,KAAD,CAAW,CACnD,GAAMC,SAAQ,CAAGR,cAAc,EAA/B,CACA,GAAMS,KAAI,CAAGR,cAAc,CAAC,SAACS,KAAD,QAAWA,MAAK,CAACC,WAAN,CAAkBF,IAA7B,EAAD,CAA3B,CAEA,GAAMG,OAAM,CAAGf,SAAS,CAAC,CACvBgB,aAAa,CAAE,CACbC,IAAI,CAAEL,IAAI,CAACK,IAAL,EAAa,EADN,CAEbC,KAAK,CAAEN,IAAI,CAACM,KAFC,CADQ,CAKvBC,QAAQ,kFAAE,iBAAOC,MAAP,qKAEiBlB,QAAO,CAACmB,UAAR,CAAmBT,IAAI,CAACU,EAAxB,CAA4BF,MAA5B,CAFjB,QAEAG,QAFA,eAGNZ,QAAQ,CAACN,OAAO,CAACkB,QAAQ,CAACC,IAAT,CAAcZ,IAAf,CAAR,CAAR,CACAF,KAAK,CAACe,oBAAN,GACAV,MAAM,CAACW,SAAP,CAAiB,UAAjB,EACAC,UAAU,CAAC,UAAM,CACfZ,MAAM,CAACW,SAAP,CAAiB,KAAjB,EACD,CAFS,CAEP,IAFO,CAAV,CANM,iFAUNE,OAAO,CAACC,GAAR,CAAY,UAAZ,cAVM,qEAAF,oFALe,CAAD,CAAxB,CAmBA,mBACE,cACE,QAAQ,CAAEd,MAAM,CAACe,YADnB,wBAGE,KAAC,gBAAD,EACE,IAAI,CAAEvB,aADR,CAEE,IAAI,CAAC,WAFP,CAGE,KAAK,CAAEK,IAAF,SAAEA,IAAF,iBAAEA,IAAI,CAAEK,IAHf,CAIE,IAAI,CAAC,MAJP,CAKE,QAAQ,CAAE,CAACP,KAAK,CAACqB,gBALnB,CAME,eAAe,CAAEhB,MAAM,CAACiB,aAAP,CAAqB,MAArB,CANnB,CAOE,KAAK,CAAEjB,MAAM,OAAN,EAAAA,MAAM,SAAN,EAAAA,MAAM,CAAEkB,OAAR,CAAgBf,KAAhB,CAAwBH,MAAxB,SAAwBA,MAAxB,iBAAwBA,MAAM,CAAEmB,MAAR,CAAejB,IAAvC,CAA8C,EAPvD,CAQE,OAAO,CAAEF,MAAM,CAACoB,MARlB,EAHF,cAaE,KAAC,gBAAD,EACE,IAAI,CAAE3B,QADR,CAEE,IAAI,CAAC,YAFP,CAGE,KAAK,CAAEI,IAAF,SAAEA,IAAF,iBAAEA,IAAI,CAAEM,KAHf,CAIE,IAAI,CAAC,OAJP,CAKE,QAAQ,CAAE,CAACR,KAAK,CAACqB,gBALnB,CAME,eAAe,CAAEhB,MAAM,CAACiB,aAAP,CAAqB,OAArB,CANnB,CAOE,KAAK,CAAEjB,MAAM,OAAN,EAAAA,MAAM,SAAN,EAAAA,MAAM,CAAEkB,OAAR,CAAgBf,KAAhB,CAAwBH,MAAxB,SAAwBA,MAAxB,iBAAwBA,MAAM,CAAEmB,MAAR,CAAehB,KAAvC,CAA+C,EAPxD,CAQE,OAAO,CAAEH,MAAM,CAACoB,MARlB,EAbF,CAuBGzB,KAAK,CAACqB,gBAAN,eACC,KAAC,YAAD,EACE,IAAI,CAAC,SADP,EAxBJ,GADF,CA+BD,CAtDD,CAwDA,cAAetB,SAAf"},"metadata":{},"sourceType":"module"}